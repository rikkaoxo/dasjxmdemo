import{_ as V}from"./page-container-obnBgMEU.js";import{r as m,a as x,u as F,o as U,c as y,b as t,d as o,f as _,c1 as k,E as P}from"./index-COjUZeQ6.js";import{E as R,a as S}from"./el-form-item-Fwc72fMp.js";import{E as q}from"./_plugin-vue_export-helper-CMIzlf7v.js";import{E as B}from"./el-input-_OoFJxtZ.js";import"./_baseClone-CfvxtYSq.js";const z={__name:"UserPassword",setup(C){const u=m(null),e=m({old_pwd:"",new_pwd:"",re_pwd:""}),i=(d,r,l)=>{r===e.value.old_pwd?l(new Error("新密码不能与原密码相同")):l()},w=(d,r,l)=>{r!==e.value.new_pwd?l(new Error("两次输入的新密码不一致")):l()},g=x(),n=F(),f=async()=>{await u.value.validate()&&(await k(e.value),P({type:"success",message:"更换密码成功"}),n.settoken(""),n.setUser({}),g.push("/login"))},c=()=>{u.value.resetFields()},v={old_pwd:[{required:!0,message:"请输入原密码",trigger:"blur"},{min:6,max:15,message:"长度在 6 到 15 个字符",trigger:"blur"}],new_pwd:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:15,message:"长度在 6 到 15 个字符",trigger:"blur"},{validator:i,trigger:"blur"}],re_pwd:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{min:6,max:15,message:"长度在 6 到 15 个字符",trigger:"blur"},{validator:w,trigger:"blur"}]};return(d,r)=>{const l=B,s=R,p=q,b=S,E=V;return U(),y(E,null,{default:t(()=>[o(b,{ref_key:"pwdFormRef",ref:u,model:e.value,rules:v,"label-width":"80px"},{default:t(()=>[o(s,{label:"原密码",prop:"old_pwd"},{default:t(()=>[o(l,{modelValue:e.value.old_pwd,"onUpdate:modelValue":r[0]||(r[0]=a=>e.value.old_pwd=a),"show-password":""},null,8,["modelValue"])]),_:1}),o(s,{label:"新密码",prop:"new_pwd"},{default:t(()=>[o(l,{modelValue:e.value.new_pwd,"onUpdate:modelValue":r[1]||(r[1]=a=>e.value.new_pwd=a),"show-password":""},null,8,["modelValue"])]),_:1}),o(s,{label:"确认密码",prop:"re_pwd"},{default:t(()=>[o(l,{modelValue:e.value.re_pwd,"onUpdate:modelValue":r[2]||(r[2]=a=>e.value.re_pwd=a),"show-password":""},null,8,["modelValue"])]),_:1}),o(s,null,{default:t(()=>[o(p,{type:"primary",onClick:f},{default:t(()=>[_("修改密码")]),_:1}),o(p,{onClick:c},{default:t(()=>[_("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}};export{z as default};
